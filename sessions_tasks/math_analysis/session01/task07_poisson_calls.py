"""
Задание 7. Распределение Пуассона (без готовых функций Python)

Условие:
    За 8 часов в колл-центр поступает в среднем 16 звонков.
    Найти вероятность того, что за 1 час поступит не более 4 и не менее 2 звонков.
    Ответ округлить до тысячных.

Пояснение:
    Интенсивность lambd (среднее количество за час):
        lambd = 16 / 8 = 2 звонка в час

    Формула Пуассона:
        P(k) = (lambd^k * e^(-lambd)) / k!

    Нужно найти: P(2 <= k <= 4) = P(2) + P(3) + P(4)

Запуск:
    poetry run python -m homework_tasks.sessions_tasks.math_analysis.session01.task07_poisson_calls

Результаты вывода после запуска:

    ==== ЗАДАНИЕ 7 - Распределение Пуассона ====
    lambd = 2
    P(2) = 0.27067
    P(3) = 0.18045
    P(4) = 0.09022
    --------------------------------------------
    Ответ: вероятность того, что за час поступит
    от 2 до 4 звонков = 0.541
"""

import math


def poisson_p(k: int, lambd: float) -> float:
    """
    Вычисляет вероятность P(k) по формуле Пуассона
    """
    return (lambd ** k) * math.exp(-lambd) / math.factorial(k)


def main() -> None:
    """
    Алгоритм решения:
        1. Определяем lambd = 2 (среднее количество звонков в час).
        2. Считаем P(k) для k = 2, 3, 4.
        3. Складываем вероятности, округляем до тысячных.
    """
    # Среднее число звонков в час
    lambd = 2

    # 1) Считаем вероятности для каждого k вручную
    probs = [poisson_p(k, lambd) for k in range(2, 5)]

    # 2) Суммируем и округляем до тысячных
    total_p = round(sum(probs), 3)

    # 3) Выводим
    print("\n==== ЗАДАНИЕ 7 - Распределение Пуассона ====")
    print(f"lambd = {lambd}")
    for k, p in zip(range(2, 5), probs):
        print(f"P({k}) = {p:.5f}")
    print("--------------------------------------------")
    print(f"Ответ: вероятность того, что за час поступит \nот 2 до 4 звонков = {total_p:.3f}")


if __name__ == "__main__":
    main()
