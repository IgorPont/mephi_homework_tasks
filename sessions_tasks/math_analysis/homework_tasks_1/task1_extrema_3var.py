"""
Условие задания № 1:
    Найдите экстремумы функции:
    f(x, y, z) = 2 * x**3 + 2*x*y + 2*x*z + y**2 + z**2 + 2*y - 8
    Распишите подробное решение.
"""

import sympy as sp


def main() -> None:
    """
    Этапы решения задания:
        1. Вычисляем частные производные f_x, f_y, f_z.
        2. Составляем систему уравнений из частных производных df/dx = 0, df/dy = 0, df/dz = 0.
        3. Решаем систему и находим стационарные точки.
        4. Анализируем Гессиан (матрицу вторых производных) для классификации экстремумов.
        5. Формулируем выводы.

    Результаты вывода:
        === Частные производные ===
        df/dx = 6*x**2 + 2*y + 2*z
        df/dy = 2*x + 2*y + 2
        df/dz = 2*x + 2*z

        === Решение системы ===
        {x: -1/3, y: -2/3, z: 1/3}
        {x: 1, y: -2, z: -1}

        === Матрица Гессе ===
        ⎡12⋅x  2  2⎤
        ⎢          ⎥
        ⎢ 2    2  0⎥
        ⎢          ⎥
        ⎣ 2    0  2⎦

        === Анализ Гессе для каждой точки ===
        Точка: {x: -1/3, y: -2/3, z: 1/3}
        Собственные значения Гессе: [2.0, -5.1231, 3.1231]
        Тип точки: седловая точка

        Точка: {x: 1, y: -2, z: -1}
        Собственные значения Гессе: [2.0, 1.2554, 12.7446]
        Тип точки: локальный минимум

        === Итог ===
        1) Вычислены частные производные и составлена система df = 0.
        2) Найдены стационарные точки и классифицированы по Гессиану.
        3) Для наглядности собственные значения округлены до 4 знаков.
    """

    # 1. Объявляем переменные и задаем исходную функцию
    x, y, z = sp.symbols("x y z", real=True)
    f = 2 * x ** 3 + 2 * x * y + 2 * x * z + y ** 2 + z ** 2 + 2 * y - 8

    # 2. Находим частные производные
    f_x = sp.diff(f, x)  # по x
    f_y = sp.diff(f, y)  # по y
    f_z = sp.diff(f, z)  # по z

    print("=== Частные производные ===")
    print(f"df/dx = {f_x}")
    print(f"df/dy = {f_y}")
    print(f"df/dz = {f_z}")

    # 3. Решаем систему уравнений для стационарных точек
    system = [
        sp.Eq(f_x, 0),
        sp.Eq(f_y, 0),
        sp.Eq(f_z, 0),
    ]

    sol = sp.solve(system, (x, y, z), dict=True)
    print("\n=== Решение системы ===")
    for s in sol:
        print(s)

    # 4. Анализ второго порядка (Гессиан)
    H = sp.hessian(f, (x, y, z))
    print("\n=== Матрица Гессе ===")
    sp.pprint(H)

    print("\n=== Анализ Гессе для каждой точки ===")
    for s in sol:
        H_num = H.subs(s)
        eigvals = [float(ev) for ev in H_num.eigenvals().keys()]
        eigvals_rounded = [round(ev, 4) for ev in eigvals]

        # Классификация по признакам матрицы Гессе
        if all(ev > 0 for ev in eigvals):
            classification = "локальный минимум"
        elif all(ev < 0 for ev in eigvals):
            classification = "локальный максимум"
        else:
            classification = "седловая точка"

        print(f"\nТочка: {s}")
        print(f"Собственные значения Гессе: {eigvals_rounded}")
        print(f"Тип точки: {classification}")

    print("\n=== Итог ===")
    print("1) Вычислены частные производные и составлена система df = 0.")
    print("2) Найдены стационарные точки и классифицированы по Гессиану.")
    print("3) Для наглядности собственные значения округлены до 4 знаков.")


if __name__ == "__main__":
    main()
